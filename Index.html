import React, { useState } from 'react';

// Main App component for the Ideal Weight Calculator
function App() {
  // State variables for height, weight, and calculation results
  const [height, setHeight] = useState(''); // User's height in cm
  const [weight, setWeight] = useState(''); // User's weight in kg
  const [imcResult, setImcResult] = useState(null); // Calculated IMC value
  const [imcClassification, setImcClassification] = useState(''); // Classification (e.g., "Normal weight")
  const [idealWeightRange, setIdealWeightRange] = useState(''); // Range of ideal weight for the given height
  const [showResult, setShowResult] = useState(false); // Flag to show/hide result section
  const [errorMessage, setErrorMessage] = useState(''); // Error message for invalid input

  /**
   * Handles the calculation of IMC and ideal weight range.
   * This function is triggered when the "Calcular IMC" button is clicked.
   */
  const calculateIMC = () => {
    // Clear previous error messages and results
    setErrorMessage('');
    setShowResult(false);
    setImcResult(null);
    setImcClassification('');
    setIdealWeightRange('');

    // Convert string inputs to numbers
    const parsedHeight = parseFloat(height);
    const parsedWeight = parseFloat(weight);

    // Input validation
    if (isNaN(parsedHeight) || isNaN(parsedWeight) || parsedHeight <= 0 || parsedWeight <= 0) {
      setErrorMessage('Por favor, insira valores válidos e positivos para altura e peso.');
      return;
    }

    // Convert height from centimeters to meters for IMC calculation
    const heightInMeters = parsedHeight / 100;

    // Calculate IMC using the formula: weight (kg) / (height (m) * height (m))
    const imc = parsedWeight / (heightInMeters * heightInMeters);
    setImcResult(imc.toFixed(2)); // Store IMC rounded to 2 decimal places

    // Determine IMC classification based on standard ranges
    let classification = '';
    if (imc < 18.5) {
      classification = 'Abaixo do Peso';
    } else if (imc >= 18.5 && imc < 24.9) {
      classification = 'Peso Normal';
    } else if (imc >= 25 && imc < 29.9) {
      classification = 'Sobrepeso';
    } else if (imc >= 30 && imc < 34.9) {
      classification = 'Obesidade Grau I';
    } else if (imc >= 35 && imc < 39.9) {
      classification = 'Obesidade Grau II (severa)';
    } else {
      classification = 'Obesidade Grau III (mórbida)';
    }
    setImcClassification(classification);

    // Calculate the ideal weight range based on IMC 18.5 to 24.9
    // Lower bound for ideal weight (IMC 18.5)
    const idealWeightLower = (18.5 * heightInMeters * heightInMeters).toFixed(1);
    // Upper bound for ideal weight (IMC 24.9)
    const idealWeightUpper = (24.9 * heightInMeters * heightInMeters).toFixed(1);
    setIdealWeightRange(`Entre ${idealWeightLower} kg e ${idealWeightUpper} kg`);

    // Show the result section
    setShowResult(true);
  };

  return (
    // Main container with responsive styling and Inter font
    <div className="min-h-screen bg-gradient-to-br from-blue-100 to-indigo-200 flex items-center justify-center p-4 font-sans antialiased">
      {/* Calculator card */}
      <div className="bg-white p-8 rounded-xl shadow-2xl w-full max-w-md">
        <h1 className="text-3xl font-extrabold text-center text-gray-800 mb-6">
          Calculadora de Peso Ideal
        </h1>

        {/* Input fields for height and weight */}
        <div className="mb-6">
          <label htmlFor="height" className="block text-gray-700 text-sm font-semibold mb-2">
            Altura (cm):
          </label>
          <input
            type="number"
            id="height"
            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200"
            placeholder="Ex: 175"
            value={height}
            onChange={(e) => setHeight(e.target.value)}
            aria-label="Input para altura em centímetros"
          />
        </div>

        <div className="mb-8">
          <label htmlFor="weight" className="block text-gray-700 text-sm font-semibold mb-2">
            Peso (kg):
          </label>
          <input
            type="number"
            id="weight"
            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200"
            placeholder="Ex: 70"
            value={weight}
            onChange={(e) => setWeight(e.target.value)}
            aria-label="Input para peso em quilogramas"
          />
        </div>

        {/* Error message display */}
        {errorMessage && (
          <p className="text-red-600 text-center text-sm mb-4 font-medium" role="alert">
            {errorMessage}
          </p>
        )}

        {/* Calculation button */}
        <button
          onClick={calculateIMC}
          className="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition duration-300 transform hover:scale-105"
          aria-label="Botão para calcular o IMC"
        >
          Calcular IMC
        </button>

        {/* Result display section, conditionally rendered */}
        {showResult && (
          <div className="mt-8 p-6 bg-blue-50 rounded-xl border border-blue-200 shadow-inner animate-fade-in-up">
            <h2 className="text-2xl font-bold text-gray-800 mb-4 text-center">Seus Resultados</h2>
            <p className="text-lg text-gray-700 mb-2">
              <span className="font-semibold">Seu IMC:</span> {imcResult}
            </p>
            <p className="text-lg text-gray-700 mb-2">
              <span className="font-semibold">Classificação:</span>{' '}
              <span className="font-bold text-blue-700">{imcClassification}</span>
            </p>
            <p className="text-lg text-gray-700 mb-4">
              <span className="font-semibold">Faixa de Peso Ideal:</span>{' '}
              <span className="font-bold text-green-700">{idealWeightRange}</span>
            </p>
            <p className="text-sm text-gray-600 italic mt-4 text-center">
              * O cálculo do IMC é uma estimativa e não substitui a avaliação de um profissional de
              saúde.
            </p>
          </div>
        )}
      </div>
    </div>
  );
}

// Ensure Tailwind CSS is loaded (this is typically done in the HTML template)
// <script src="https://cdn.tailwindcss.com"></script>

export default App; // Export the App component for use in an HTML environment
